<?php setlocale (LC_TIME, 'fr_FR.utf8','fra'); ?>
<div class="recherche">
    <form method="POST" action="<?php echo $this->baseUrl('commercial/detailsrecherche');?>" onSubmit="return verif()">
        <div class="aller">
            <?php
                $i = 0;
                foreach ($this->tabVol as $vol) {
                    if ($i == 0) {
                        echo 'Votre vol aller : ' . $vol['depart'] . ' à ' . $vol['arrive'];
                    }
                    $i++;
                }
            ?>
            <table>
                <thead>
                    <th>Prix</th>
                    <th>Vol N°</th>
                    <th>Départ</th>
                    <th>Arrivée</th>
                    <th>Durée</th>
                </thead>
                <tbody>
                    <?php 
                        foreach ($this->tabVol as $vol) {
                            $d = date('Y-m-d H:i:s', $vol['heure_dep']);
                            $a = date('Y-m-d H:i:s', $vol['heure_arr']);
                            $dep = new DateTime($d);
                            $arr = new DateTime($a);
                            $duree = $dep->diff($arr);
                            ?>
                                <tr>
                                    <td>
                                        <input type="radio" name="volAller" value="<?php echo $vol['numero_vol'].'/'.$vol['heure_dep'].'/'.$vol['prix'];?>"/>
                                        <?php echo $vol['prix'].'€'; ?>
                                    </td>

                                    <td><?php echo $vol['numero_vol']; ?></td>

                                    <td><?php echo strftime("%A %d %B à %H:%M",$vol['heure_dep']); ?></td>

                                    <td><?php echo strftime("%A %d %B à %H:%M",$vol['heure_arr']);?></td>

                                    <td>
                                        <?php echo $duree->h . ':' . $duree->i; ?>
                                        <?php
                                            if ($duree->d > 0) {
                                                echo '+' . $duree->d .'Jour';
                                            }
                                        ?>
                                    </td>
                                </tr>
                            <?php 
                        }
                    ?>
                </tbody>
            </table>
        </div>
        <?php 
            if(isset($this->tabVolRetour) && $this->tabVolRetour != '') {
                $i = 0;
                foreach ($this->tabVolRetour as $volRetour) {
                    if ($i == 0) {
                        echo 'Votre vol retour : ' . $volRetour['depart'] . ' à ' . $volRetour['arrive'];
                    }
                    $i++;
                }
                ?>
                    <div class="retour">
                        <table>
                            <thead>
                                <th>Prix</th>
                                <th>Vol N°</th>
                                <th>Départ</th>
                                <th>Arrivée</th>
                                <th>Durée</th>
                            </thead>
                            <tbody>
                                <?php 
                                    foreach ($this->tabVolRetour as $volRetour) {
                                        $d = date('Y-m-d H:i:s', $volRetour['heure_dep']);
                                        $a = date('Y-m-d H:i:s', $volRetour['heure_arr']);
                                        $dep = new DateTime($d);
                                        $arr = new DateTime($a);
                                        $duree = $dep->diff($arr);
                                        ?>
                                            <tr>
                                                <td>
                                                    <input type="radio" name="volRetour" value="<?php echo $volRetour['numero_vol'].'/'.$volRetour['heure_dep'].'/'.$volRetour['prix'];?>"/>
                                                    <?php echo $volRetour['prix'].'€'; ?>
                                                </td>

                                                <td><?php echo $volRetour['numero_vol']; ?></td>

                                                <td><?php echo strftime("%A %d %B à %H:%M",$volRetour['heure_dep']);?></td>

                                                <td><?php echo strftime("%A %d %B à %H:%M",$volRetour['heure_arr']);?></td>

                                                <td>
                                                    <?php echo $duree->h . ':' . $duree->i; ?>
                                                    <?php
                                                        if ($duree->d > 0) {
                                                            echo '+' . $duree->d .'Jour';
                                                        }
                                                    ?>
                                                </td>
                                            </tr>
                                        <?php 
                                    }
                                ?>
                            </tbody>
                        </table>
                    </div>
                <?php 
            }
        ?>
        <input type="submit" name="reserve" value="Valider votre parcours" class="bgRedBtn" />
    </form>
</div>